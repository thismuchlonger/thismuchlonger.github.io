<!DOCTYPE html>
  <head>
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/stylesheets/application.css">
    <script type="text/javascript" src="/javascripts/jquery.js"></script>
    <script type="text/javascript" src="/javascripts/bootstrap.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        function Grid(canvas) {
          this.canvas = canvas;
          this.days = 10000;
          this.size = 7;
          this.padding = 2;
          this.canvasContext = canvas[0].getContext("2d");

          this.width = function() {
            return canvas.width();
          };

          this.minWidth = function() {
            return this.daysPerRow() * (this.size + this.padding);
          }

          this.height = function() {
            return Math.ceil(this.days / this.daysPerRow()) * (this.size + this.padding);
          };

          this.container = function() {
            return $(canvas.parent());
          };

          this.daysPerRow = function() {
            return Math.floor(this.width() / (this.padding + this.size));
          };

          this.row = function(day) {
            return Math.floor(day / this.daysPerRow());
          };

          this.rowValue = function(day) {
            return this.row(day) * (this.size + this.padding);
          };

          this.colValue = function(day) {
            return (day * (this.size + this.padding)) - (this.row(day) * this.daysPerRow() * (this.padding + this.size));
          };

          this.excess = function() {
            return this.width() % (this.size + this.padding);
          };

          this.coords = function(day) {
            var array = [];

            for (var day=0; day<grid.days; day++){
              array.push([this.colValue(day),this.rowValue(day)]);
            }

            return array;
          };

          this.draw = function() {
            grid.canvas.attr('height', this.height());
            grid.canvas.attr('width', this.minWidth());

            var coords = this.coords();

            for (var day = 0; day < grid.days; day++){
              this.canvasContext.fillRect(coords[day][0], coords[day][1], this.size, this.size);
            };
          };
        };

        function respondCanvas(grid) {
          grid.canvas.attr('width', grid.container().width());

          grid.draw();
        }

        var grid = new Grid($("#days"));
        respondCanvas(grid);

        $(window).resize(function(){
          // respondCanvas(grid);
        });
      });
    </script>
  </head>
  <body>
    <header>
        <nav class="navbar navbar-default navbar-static-top" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <a class="navbar-brand" href="/">not much longer</a>
            </div>
          </div>
        </nav>
    </header>

    <main>
      <section class="container">
        <meter max="100" value="80"></meter>
      </section>

      <section class="container">
        <div class="canvasContainer">
          <canvas id="days" width="1000" height="500"></canvas>
        </div>
      </section>
    </main>

    <footer>
    </footer>
  </body>
</html>
